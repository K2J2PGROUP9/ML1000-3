"0","airbnb_test <- airbnb_test %>% filter(price <= quantile(airbnb_train$price, 0.9) & price >= quantile(airbnb_train$price, 0.1)) %>% tidyr::drop_na()"
"0","pred_regression <- predict(second_model, newdata = airbnb_test)"
"0","pred_regression <- exp(pred_regression)"
"0",""
"0","RMSE_regression <- sqrt(mean( (airbnb_test$price - pred_regression)**2 ))"
"0",""
"0","SSE <- sum((airbnb_test$price - pred_regression)**2)"
"0","SSR <- sum((pred_regression - mean(airbnb_test$price)) ** 2)"
"0","R2 <- 1 - SSE/(SSE + SSR)"
"0","RMSE_regression"
"1","[1]"
"1"," 44.81829"
"1","
"
"0","R2"
"1","[1]"
"1"," 0.2648741"
"1","
"
"0","regression_results <- tibble("
"0","  obs = airbnb_test$price,"
"0","  pred = pred_regression,"
"0","  diff = pred - obs,"
"0","  abs_diff = abs(pred - obs),"
"0","  neighbourhood = airbnb_test$neighbourhood,"
"0","  name = airbnb_test$name,"
"0","  type = airbnb_test$room_type"
"0","  "
"0",")"
"0",""
"0","regression_plot <- regression_results %>% "
"0","  ggplot(aes(obs, pred)) +"
"0","geom_point(alpha = 0.1, aes(text = paste(""Name:"", name, ""\nType:"", type,"
"0","                                           ""\nPrice diff = "", diff))) +"
"0","  th +"
"0","  scale_x_log10() +"
"0","  scale_y_log10() +"
"0","  ggtitle(""Observed vs predicted"","
"0","          subtitle = ""Linear regression model"") + "
"0","  geom_abline(slope = 1, intercept = 0, color = ""blue"", linetype = 2)  +"
"0","  facet_wrap(~type)"
"2","Ignoring unknown aesthetics: text"
